<mat-accordion>
    <mat-expansion-panel>
        <mat-expansion-panel-header>
            <mat-panel-title>
                <strong>Playground</strong>
            </mat-panel-title>
            <mat-panel-description>
                Build your own network!!
            </mat-panel-description>
        </mat-expansion-panel-header>

        <form [formGroup]="playgroundForm" fxLayout="row wrap">
            <div style="margin-top: 0.5rem;">
                <strong>Mnist Data</strong>
            </div>
            <div fxFlex="grow"></div>
            <div>
                <mat-form-field>
                    <input matInput placeholder="Batch Size" type="text" formControlName="batchSize">
                </mat-form-field>
                <mat-form-field>
                    <input matInput placeholder="Number of Batches" type="text" formControlName="numBatches">
                </mat-form-field>
                <mat-form-field>
                    <input matInput placeholder="Epoch" type="text" formControlName="epoch">
                </mat-form-field>
            </div>
            <div fxFlex="grow"></div>
            <div style="margin-top: 0.5rem;">
                <strong>Model</strong>
            </div>
            <div fxFlex="grow"></div>
            <mat-form-field>
                <input matInput placeholder="Number of Layers" type="number" formControlName="layerCount">
            </mat-form-field>
            <mat-form-field>
                <mat-select placeholder="Learning Rate" formControlName="learningRate">
                    <mat-option *ngFor="let learningRate of playgroundData.learningRates" [value]="learningRate.value">
                        {{ learningRate.viewValue }}
                    </mat-option>
                </mat-select>
            </mat-form-field>
            <div fxFlex="grow"></div>
            <div>
                <div formArrayName="layers">
                    <div *ngFor="let layer of layers.controls; let i=index" [formGroupName]="i">
                        <div style="margin-top: 0.5rem;">
                            <strong> {{ i+1 | ordinal }} Layer</strong>
                        </div>
                        <div fxLayout="row wrap">
                            <mat-form-field>
                                <input matInput placeholder="Number of Units" type="number" formControlName="unitCount">
                            </mat-form-field>
                            <button mat-icon-button (click)="delLayer(i)">
                                <mat-icon>delete</mat-icon>
                            </button>
                        </div>
                        <mat-divider></mat-divider>
                    </div>
                </div>
            </div>
            <mat-action-row style="width: 100%;">
                <button mat-button color="accent" (click)="reset()">Reset</button>
                <button mat-button color="accent" (click)="trainNetwork()" [disabled]="!this.playgroundForm.valid">Train Network</button>
            </mat-action-row>
        </form>
    </mat-expansion-panel>

    <mat-expansion-panel>
        <mat-expansion-panel-header>
            <mat-panel-title>
                <strong>Setup</strong>
            </mat-panel-title>
        </mat-expansion-panel-header>


        <mat-form-field>
            <mat-select placeholder="File">
                <mat-option *ngFor="let file of files" [value]="file.value" (click)="selectedFile=file.value">
                    {{ file.viewValue }}
                </mat-option>
            </mat-select>
        </mat-form-field>
        <div class="spacer"></div>
        <mat-slide-toggle class="form-field">Neural Netowrk</mat-slide-toggle>
        <mat-slide-toggle class="form-field">ANN</mat-slide-toggle>
        <div fxLayout="row wrap" fxLayoutAlign="start center">
            <div class="form-field">Epoch</div>
            <div>{{epochRange[0]}}</div>
            <nouislider [connect]="true" [min]="1" [max]="100" [step]="1" [(ngModel)]="epochRange"></nouislider>
            <div>{{epochRange[1]}}</div>
        </div>
        <form>
            <mat-action-row>
                <button mat-button color="accent" (click)="startCalc()">Start the Calculation</button>
                <button mat-button color="accent" (click)="testFunction()">Test</button>
            </mat-action-row>
        </form>
    </mat-expansion-panel>

    <mat-expansion-panel>
        <mat-expansion-panel-header>
            <mat-panel-title>
                <strong>Heatmap Config</strong>
            </mat-panel-title>
        </mat-expansion-panel-header>

        <mat-form-field>
            <input matInput placeholder="Radius" value="4" type="number">
        </mat-form-field>
        <mat-form-field>
            <input matInput placeholder="Blur" value="2" type="number">
        </mat-form-field>
        <div fxLayout="row wrap" fxLayoutAlign="start center">
            <div class="form-field">Minimum Opacity</div>
            <mat-slider min="1" max="100" step="1" [value]="minOpac" (input)="minOpac=$event.value;"></mat-slider>
            <div>{{(minOpac/100)}}</div>
        </div>
        <div fxLayout="row wrap" class="color-config">
            <div fxLayout="row wrap" fxLayoutAlign="start center" class="form-field">
                <label class="form-field">Color 1</label>
                <mcc-color-picker [usedColorLabel]="'My Colors'" [usedSizeColors]="'7'" (change)="color1=$event" (selected)="color1=$event">
                    <mcc-color-picker-collection [label]="'First Collection'" [colors]="colors" [size]="16"> </mcc-color-picker-collection>
                </mcc-color-picker>
            </div>
            <div class="spacer"></div>
            <div fxLayout="row wrap" fxLayoutAlign="start center">
                <div class="form-field">Color 1 Trigger</div>
                <mat-slider min="1" max="100" step="1" [value]="col1Trigger" (input)="col1Trigger=$event.value;"></mat-slider>
                <div>{{(col1Trigger/100)}}</div>
            </div>
        </div>
        <div fxLayout="row wrap" class="color-config">
            <div fxLayout="row wrap" fxLayoutAlign="start center" class="form-field">
                <label class="form-field">Color 2</label>
                <mcc-color-picker [usedColorLabel]="'My Colors'" [usedSizeColors]="'7'" (change)="color2=$event" (selected)="color2=$event">
                    <mcc-color-picker-collection [label]="'First Collection'" [colors]="colors" [size]="16"> </mcc-color-picker-collection>
                </mcc-color-picker>
            </div>
            <div class="spacer"></div>
            <div fxLayout="row wrap" fxLayoutAlign="start center">
                <div class="form-field">Color 2 Trigger</div>
                <mat-slider min="1" max="100" step="1" [value]="col2Trigger" (input)="col2Trigger=$event.value;"></mat-slider>
                <div>{{(col2Trigger/100)}}</div>
            </div>
        </div>
        <div fxLayout="row wrap" class="color-config">
            <div fxLayout="row wrap" fxLayoutAlign="start center" class="form-field">
                <label class="form-field">Color 3</label>
                <mcc-color-picker [usedColorLabel]="'My Colors'" [usedSizeColors]="'7'" (change)="color3=$event" (selected)="color3=$event">
                    <mcc-color-picker-collection [label]="'First Collection'" [colors]="colors" [size]="16"> </mcc-color-picker-collection>
                </mcc-color-picker>
            </div>
            <div class="spacer"></div>
            <div fxLayout="row wrap" fxLayoutAlign="start center">
                <div class="form-field">Color 3 Trigger</div>
                <mat-slider min="1" max="100" step="1" [value]="col3Trigger" (input)="col3Trigger=$event.value;"></mat-slider>
                <div>{{(col3Trigger/100)}}</div>
            </div>
        </div>
    </mat-expansion-panel>
</mat-accordion>

<div>
    <h3>TensorFlow.js: Train MNIST with the Layers API</h3>
    <app-playground-viz [topology]="playgroundForm.value"></app-playground-viz>
</div>
<!-- <canvas #canvas></canvas>
<app-brain #brainComponent (updatedHeatmapData)="updateHeatmapData($event)" (updatedHeatmapCanvasTexture)="updateHeatmapCanvasTexture($event)"></app-brain>
<app-molecule #moleculeComponent></app-molecule> -->